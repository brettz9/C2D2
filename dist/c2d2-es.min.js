function _forEach(t,e){for(let o=0,a=t.length;o<a;o++)e(t[o],o)}function _arrayify(t){let e=arguments;if("string"==typeof t){e=[],_forEach(t.trim().replace(/\s*,\s+/g,", ").split(/\s+/),(t,o)=>{e[o]=t.split(", ")})}return e}const w="undefined"==typeof window?global:window;function buildMethod(t){return function(...e){return this.parent[t](...e),this}}function buildGetterMethod(t,e,o){return function(a){const r=[].slice.call(arguments);return"putImageData"===t&&"object"==typeof a&&a.imageData&&(r[0]=a.imageData),new o(e?this.parent[t]:this.parent[t](...r))}}function buildLiteralGetterMethod(t){return function(...e){return this.parent[t](...e)}}function buildPropertyMethod(t){return function(e){return void 0===e?this.parent[t]:(this.parent[t]=e,this)}}function buildContextMethods(t){return function(...e){return t.apply(this,e),this}}const DelegateChain={addMethods(t,e){for(let o=0,a=t.length;o<a;o++){const a=t[o];e.prototype[a]=buildMethod(a)}},addGetterMethods(t,e,o,a){for(let r=0,n=t.length;r<n;r++){const n=t[r];e.prototype[n]=o?buildGetterMethod(n,a,o):buildLiteralGetterMethod(n)}},addPropertyMethods(t,e){for(let o=0,a=t.length;o<a;o++){const a=t[o];e.prototype[a]=buildPropertyMethod(a)}}};function _C2D2CanvasPixelArraySetup(){C2D2CanvasPixelArray.prototype.item=function(t,e){return void 0===e?this.parent[t]:(this.parent[t]=e,this)},DelegateChain.addPropertyMethods(["length"],C2D2CanvasPixelArray)}function C2D2CanvasPixelArray(t){C2D2CanvasPixelArray.prototype.length||_C2D2CanvasPixelArraySetup(),this.parent=this.array=this.pixelArray=t}function _C2D2ImageDataSetup(){DelegateChain.addGetterMethods(["data"],C2D2ImageData,C2D2CanvasPixelArray,!0),DelegateChain.addPropertyMethods(["width","height","resolution"],C2D2ImageData)}function C2D2ImageData(t){C2D2ImageData.prototype.width||_C2D2ImageDataSetup(),this.parent=this.imageData=t}function _C2D2GradientSetup(){DelegateChain.addMethods(["addColorStop"],C2D2Gradient)}function C2D2Gradient(t){C2D2Gradient.prototype.addColorStop||_C2D2GradientSetup(),this.parent=this.gradient=t}function C2D2Pattern(t){return this.parent=this.pattern=t,t}function _C2D2ContextSetup(){DelegateChain.addMethods(["addHitRegion","arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","commit","drawImage","drawSystemFocusRing","ellipse","fill","fillRect","fillText","getLineDash","lineTo","moveTo","quadraticCurveTo","rect","removeHitRegion","resetClip","resetTransform","restore","rotate","save","scale","scrollPathIntoView","setLineDash","setTransform","stroke","strokeRect","strokeText","transform","translate"],C2D2Context),DelegateChain.addGetterMethods(["createImageData","createImageDataHD","getImageData","getImageDataHD","putImageData","putImageDataHD"],C2D2Context,C2D2ImageData),DelegateChain.addGetterMethods(["createLinearGradient","createRadialGradient"],C2D2Context,C2D2Gradient),DelegateChain.addGetterMethods(["createPattern"],C2D2Context,C2D2Pattern),DelegateChain.addGetterMethods(["drawCustomFocusRing","isPointInPath","isPointInStroke","measureText"],C2D2Context),DelegateChain.addPropertyMethods(["canvas","currentTransform","direction","fillStyle","font","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor","strokeStyle","textAlign","textBaseline"],C2D2Context)}function c2d2Element(t,e){let o=e;const a=w.document||null,r="object"!=typeof t||!t.length;r?(o=e=t,t=[]):e=e||{};const n=e&&(e.path||e.fileStream);let i;if("string"==typeof e)o=a.getElementById(e);else if("object"==typeof e&&n){o=new(require("canvas"));const a=t[0]||e.width||e.w,r=t[1]||e.height||e.h;a&&(o.width=a),r&&(o.height=r);const n=e.fileStream||e.path;if(n){const t=require("fs").createWriteStream(n),e=o.createPNGStream();e.on("data",e=>{t.write(e)}),e.on("end",()=>{t.end()})}}else"object"!=typeof e||e.nodeName?void 0===e&&(o=a.getElementsByTagName("canvas")[0]):(o=a.createElementNS&&null!==a.documentElement.namespaceURI?a.createElementNS("http://www.w3.org/1999/xhtml","canvas"):a.createElement("canvas"),(e.width||e.w)&&o.setAttribute("width",e.width||e.w),(e.height||e.h)&&o.setAttribute("height",e.height||e.h),e.id&&o.setAttribute("id",e.id),e.style&&o.setAttribute("style",e.style),e.innerHTML&&(o.innerHTML=e.innerHTML),(e.class||e.className)&&o.setAttribute("class",e.class||e.className),i=e.appendTo?"string"==typeof e.appendTo?a.getElementById(e.appendTo):e.appendTo:a.body);return!r&&o.setAttribute&&(o.setAttribute("width",t[0]),o.setAttribute("height",t[1])),i&&i.appendChild(o),w.G_vmlCanvasManager&&(o=w.G_vmlCanvasManager.initElement(o)),o}function C2D2Context(t,e){if(!(this instanceof C2D2Context))return new C2D2Context(t,e);const o=this.canvas=c2d2Element(t,e);return this.context=this.parent=o.getContext("2d"),C2D2Context.prototype.arc||_C2D2ContextSetup(),this.width=o.width,this.height=o.height,this}_forEach(["transferControlToProxy","getContext","probablySupportsContext","supportsContext","setContext","toDataURL","toDataURLHD","toBlob","toBlobHD"],function(t){C2D2Context.prototype[t]=function(...e){return this.canvas[t](...e)}}),C2D2Context.addMethods=function(t){Object.entries(t).forEach(([t,e])=>{C2D2Context.prototype[t]=buildContextMethods(e)})},C2D2Context.extend=function(t){Object.entries(t).forEach(([t,e])=>{C2D2Context.prototype[t]=e})},C2D2Context.addMethods({$line(t,e){let o;t&&"object"==typeof t&&!t.length?(t.color&&this.$lineColor(t.color),(t.width||t.w)&&this.lineWidth(t.width||t.w),(t.shadow||t.$shadow)&&this.$shadow(t.shadow),o=_arrayify.apply(null,t.coords||t.xy||t.path)):o=_arrayify.apply(null,arguments),this.beginPath().moveTo.apply(this,o[0]);for(let t=1,e=o.length;t<e;t++)this.lineTo(...o[t]);(e||t.close)&&this.closePath(),this.stroke()},$fill(t){let e;if(t&&"object"==typeof t&&!t.length?(t.color&&this.$fillColor(t.color),(t.shadow||t.$shadow)&&this.$shadow(t.shadow),e=_arrayify.apply(null,t.coords||t.xy||t.path)):e=_arrayify.apply(null,arguments),4===e[0].length)return this.$fillRect(...e);this.beginPath().moveTo.apply(this,e[0]);for(let t=1,o=e.length;t<o;t++)this.lineTo(...e[t]);this.fill()},$clear(...t){this.$clearRect(...t)},$fillRect(t,e,o,a){if(t&&"object"==typeof t&&t.length){for(let t=0,e=arguments.length;t<e;t++)this.$fillRect(...arguments[t]);return this}this.fillRect(t||0,e||0,o||this.width,a||this.height)},$clearRect(t,e,o,a){if(t&&"object"==typeof t&&t.length){for(let t=0,e=arguments.length;t<e;t++)this.$clearRect(...arguments[t]);return this}this.clearRect(t||0,e||0,o||this.width,a||this.height)},$strokeRect(t,e,o,a){if(t&&"object"==typeof t&&t.length){for(let t=0,e=arguments.length;t<e;t++)this.$strokeRect(...arguments[t]);return this}this.strokeRect(t||0,e||0,o||this.width,a||this.height)},$arc(t,e,o,a,r,n){if(t&&"object"==typeof t&&t.length){for(let t=0,e=arguments.length;t<e;t++)this.$arc(...arguments[t]);return this}this.arc(t,e,o,a,r,n)},$quadraticCurve(...t){this.$quadratic(...t)},$quadraticCurveTo(...t){this.$quadratic(...t)},$quadratic(t,e,o,a){if(t&&"object"==typeof t&&t.length){for(let t=0,e=arguments.length;t<e;t++)this.$quadratic(...arguments[t]);return this}this.quadraticCurveTo(t,e,o,a)},$bezierCurve(...t){this.$bezier(...t)},$bezierCurveTo(...t){this.$bezier(...t)},$bezier(t,e,o,a,r,n){if(t&&"object"==typeof t&&t.length){for(let t=0,e=arguments.length;t<e;t++)this.$bezier(...arguments[t]);return this}this.bezierCurveTo(t,e,o,a,r,n)}}),C2D2Context.extend({$shadowColor(t){return"random"===t&&(t=C2D2Context.randomColor()),this.shadowColor(t)},$fillColor(t){return"random"===t&&(t=C2D2Context.randomColor()),this.fillStyle(t)},$lineColor(t){return"random"===t&&(t=C2D2Context.randomColor()),this.strokeStyle(t)},$imageData(...t){return"object"==typeof t[0]&&void 0!==t[1]?(this.putImageData(...t),this):void 0!==t[2]?this.getImageData(...t):this.createImageData(...t)},$shadowOffset(t,e){return void 0===t?[this.shadowOffsetX(),this.shadowOffsetY()]:("object"==typeof t&&!e&&t.length?(e=t[1],t=t[0]):"string"==typeof t&&-1!==t.indexOf(", ")&&([t,e]=t.split(/\s*,\s*/)),this.shadowOffsetX(t).shadowOffsetY(e),this)},$shadowBlur(...t){this.shadowBlur(...t)},$shadowOffsetY(...t){this.shadowOffsetY(...t)},$shadowOffsetX(...t){this.shadowOffsetX(...t)},$shadow(t){return void 0===t?{offset:this.$shadowOffset(),blur:this.shadowBlur(),color:this.$shadowColor(),offsetX:this.shadowOffsetX(),offsetY:this.shadowOffsetY()}:(Object.entries(t).forEach(([t,e])=>{"offset"===t?this.$shadowOffset(e):this[`$shadow${t.charAt(0).toUpperCase()+t.slice(1)}`](e)}),this)}}),C2D2Context.randomNumber=function(t,e){return t=t||0,e=e||1,Math.floor(Math.random()*(e-t+1))+t},C2D2Context.randomColor=function(t,e,o,a,r,n){return t=t||0,e=e||0,o=o||0,a=a||255,r=r||255,n=n||255,`rgb${C2D2Context.randomNumber(t,a)}, ${C2D2Context.randomNumber(e,r)}, ${C2D2Context.randomNumber(o,n)})`},C2D2Context.getCSSPropertyValue=function(t,e,o){function a(t,e,o){const a=t.cssRules||t.rules;for(let t=0,r=a.length;t<r;t++){const r=a[t];try{if(1===r.type&&r.selectorText===e)return r.style.getPropertyValue(o)}catch(t){if(r.selectorText===e)return o=o.replace(/-([a-z])/g,String.prototype.toUpperCase),r.style[o]}}return!1}let r,n;if(void 0!==o)return a(r=document.styleSheets[o],t,e);for(let o=0,i=document.styleSheets.length;o<i&&!(n=a(r=document.styleSheets[o],t,e));o++);return n},C2D2Context.CanvasPixelArray=C2D2CanvasPixelArray,C2D2Context.ImageData=C2D2ImageData,C2D2Context.Gradient=C2D2Gradient,C2D2Context.Pattern=C2D2Pattern,C2D2Context.canvasElement=c2d2Element;export default C2D2Context;
//# sourceMappingURL=c2d2-es.min.js.map
